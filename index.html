<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muluthan Pooja - Finance App</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600&display=swap"
        rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- jsPDF & AutoTable -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">
        <!-- Mobile Sidebar Overlay -->
        <div id="sidebar-overlay" class="sidebar-overlay"></div>

        <!-- Sidebar Navigation -->
        <nav class="sidebar" id="sidebar">
            <span id="close-sidebar-btn" class="close-sidebar-btn">&times;</span>
            <div class="logo">
                <span class="logo-icon"></span>
                <h1>Muluthan Pooja</h1>
            </div>
            <ul class="nav-links">
                <li class="active" data-view="dashboard">
                    <span class="icon">üìä</span> Dashboard
                </li>
                <li data-view="donations">
                    <span class="icon">üôè</span> Donations
                </li>
                <li data-view="expenses">
                    <span class="icon">üí∏</span> Expenses
                </li>
                <li data-view="seva">
                    <span class="icon">ü§ù</span> Seva (Duties)
                </li>
                <li data-view="attendance">
                    <span class="icon">üìã</span> Namelist
                </li>
                <li data-view="reports">
                    <span class="icon">üìë</span> Reports
                </li>
            </ul>

            <div style="margin-bottom: 2rem; padding: 0 0.5rem;">
                <label
                    style="display:block; margin-bottom:0.5rem; font-size:0.85rem; font-weight:600; color:var(--color-text-muted);">Select
                    Year</label>
                <div style="display:flex; gap:0.5rem;">
                    <select id="year-select"
                        style="flex:1; border-color:var(--color-primary); background:var(--color-bg);">
                        <!-- Populated by JS -->
                    </select>
                    <button id="add-year-btn"
                        style="padding:0 0.5rem; background:var(--color-gold); border:none; border-radius:4px; color:white; cursor:pointer; font-size:1.2rem; line-height:1;">+</button>
                </div>
            </div>

            <div class="user-profile">
                <div class="avatar">A</div>
                <div class="info">
                    <p class="name">Admin User</p>
                    <p class="role">Organizer</p>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <header class="top-bar">
                <div style="display:flex; align-items:center; gap:1rem;">
                    <button id="menu-btn" class="menu-btn"
                        style="display:none; background:none; border:none; font-size:1.5rem; cursor:pointer;">‚ò∞</button>
                    <h2 id="page-title">Dashboard</h2>
                </div>
                <div class="actions">
                    <button class="btn btn-primary" id="add-transaction-btn">+ Add New</button>
                </div>
            </header>

            <!-- Dashboard View -->
            <section id="dashboard" class="view active">
                <div class="stats-grid">
                    <div class="stat-card" style="--accent-color: var(--color-gold);">
                        <h3>Total Donations</h3>
                        <p class="amount" id="dash-total-donations">‚Çπ0</p>
                    </div>
                    <div class="stat-card" style="--accent-color: var(--color-red);">
                        <h3>Total Expenses</h3>
                        <p class="amount" id="dash-total-expenses">‚Çπ0</p>
                    </div>
                    <div class="stat-card" style="--accent-color: var(--color-green);">
                        <h3>Remaining Balance</h3>
                        <p class="amount" id="dash-balance">‚Çπ0</p>
                    </div>
                </div>

                <div class="charts-container">
                    <div class="chart-card">
                        <h3>Overview</h3>
                        <canvas id="balanceChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>Expense Breakdown</h3>
                        <canvas id="expenseChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Donations View -->
            <section id="donations" class="view">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Name</th>
                                <th>Family</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody id="donations-list">
                            <!-- Items will be populated here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Expenses View -->
            <section id="expenses" class="view">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Category</th>
                                <th>Description</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody id="expenses-list">
                            <!-- Items will be populated here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Seva View -->
            <section id="seva" class="view">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Member Name</th>
                                <th>Assigned Duty</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="seva-list">
                            <!-- Items will be populated here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Attendance View -->
            <section id="attendance" class="view">
                <div
                    style="background:var(--color-surface); padding:1rem; border-radius:var(--radius-md); box-shadow:var(--shadow-sm); margin-bottom:1rem; display:flex; justify-content:space-between; align-items:center;">
                    <h3 style="margin:0; font-family:var(--font-heading); color:var(--color-primary);">Attendance List
                    </h3>
                    <div style="text-align:right;">
                        <span style="display:block; font-size:0.85rem; color:var(--color-text-muted);">Total
                            Confirmed</span>
                        <span id="total-pax-count"
                            style="font-size:1.5rem; font-weight:700; color:var(--color-green);">0</span>
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Family</th>
                                <th>Pax</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="attendance-list">
                            <!-- Items will be populated here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Reports View (Placeholder) -->
            <section id="reports" class="view">
                <div
                    style="background:var(--color-surface); padding:2rem; border-radius:var(--radius-lg); box-shadow:var(--shadow-md);">
                    <h3 style="margin-bottom:1.5rem; font-family:var(--font-heading); color:var(--color-primary);">
                        Export Data</h3>
                    <p style="margin-bottom:2rem; color:var(--color-text-muted);">Download your financial data for the
                        selected year as CSV files.</p>

                    <div style="display:flex; gap:1.5rem; flex-wrap:wrap;">
                        <button id="export-donations-btn" class="btn btn-primary"
                            style="display:flex; align-items:center; gap:0.5rem;">
                            <span>ÔøΩ</span> Export Donations (PDF)
                        </button>
                        <button id="export-expenses-btn" class="btn btn-primary"
                            style="display:flex; align-items:center; gap:0.5rem; background-color:var(--color-gold);">
                            <span>ÔøΩ</span> Export Expenses (PDF)
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal for Adding Items -->
    <div id="modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="modal-title">Add Entry</h2>
            <form id="transaction-form">
                <div class="form-group">
                    <label>Type</label>
                    <div class="toggle-group" style="flex-wrap:wrap">
                        <label class="radio-label">
                            <input type="radio" name="type" value="donation" checked> Donation
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="type" value="expense"> Expense
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="type" value="seva"> Seva (Duty)
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="type" value="attendance"> Attendance
                        </label>
                    </div>
                </div>

                <div class="form-group" id="amount-group">
                    <label for="amount">Amount (‚Çπ)</label>
                    <input type="number" id="amount" min="1">
                </div>

                <div class="form-group" id="date-group">
                    <label for="date">Date</label>
                    <input type="date" id="date">
                </div>

                <!-- Dynamic Fields based on Type -->
                <div id="donation-fields">
                    <div class="form-group">
                        <label for="donor-name">Donor Name</label>
                        <input type="text" id="donor-name">
                    </div>
                    <div class="form-group">
                        <label for="family-name">Family Head</label>
                        <input type="text" id="family-name">
                    </div>
                </div>

                <div id="expense-fields" class="hidden">
                    <div class="form-group">
                        <label for="category">Category</label>
                        <select id="category">
                            <option value="Travel">Travel</option>
                            <option value="Food">Food</option>
                            <option value="Pooja">Pooja Items</option>
                            <option value="Accommodation">Accommodation</option>
                            <option value="Misc">Miscellaneous</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="description">Description</label>
                        <input type="text" id="description">
                    </div>
                </div>

                <div id="seva-fields" class="hidden">
                    <div class="form-group">
                        <label for="seva-member">Member Name</label>
                        <input type="text" id="seva-member">
                    </div>
                    <div class="form-group">
                        <label for="seva-task">Task Description</label>
                        <input type="text" id="seva-task" placeholder="e.g. Cleaning, Flowers">
                    </div>
                </div>

                <div id="attendance-fields" class="hidden">
                    <div class="form-group">
                        <label for="att-name">Member Name</label>
                        <input type="text" id="att-name">
                    </div>
                    <div class="form-group">
                        <label for="att-family">Family</label>
                        <input type="text" id="att-family">
                    </div>
                    <div class="form-group">
                        <label for="att-pax">Pax Count</label>
                        <input type="number" id="att-pax" min="1" value="1">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary btn-block">Save</button>
            </form>
        </div>
    </div>

    <script src="store.js"></script>
    <script src="app.js"></script>
</body>

</html>